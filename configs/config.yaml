# configs/config.yaml
defaults:
  - _self_
  - al: base           # al/trust.yaml を使用
  - model: bert         # model/bert.yaml を使用
  - train: standard     # train/standard.yaml を使用
  - infer: base         # infer/base.yaml を使用
  - data: Y14_1-2_1_3          # data/base.yaml を使用
  - split: standard     # split/standard.yaml を使用
  - confidence: default # confidence/default.yaml を使用
  - gate: default       # gate/default.yaml を使用
  - run: base           # run/base.yaml を使用（中身はAL専用の共通設定）
  - cleaner: base       # cleaner/base.yaml
  - task: sas           # task/sas.yaml を使用

project_root: ${oc.env:TENSAKU_ROOT, ${hydra:runtime.cwd}}

hydra:
  run:
    # 【変更】override_dirname を sampler の前に持ってくる
    dir: ${oc.env:TENSAKU_ROOT,${hydra:runtime.cwd}}/outputs/${data.qid}/${run.tag}/${al.sampler.name}/seed=${run.seed}

  sweep:
    dir: ${oc.env:TENSAKU_ROOT,${hydra:runtime.cwd}}/outputs
    
    subdir: ${data.qid}/${run.tag}/${al.sampler.name}/seed=${run.seed}

  job:
    chdir: True

    config:
      override_dirname:

        # 【重要】ここに書いたキーはフォルダ名（override）に含まれなくなります。
        # 逆に言えば、ここに書いていないパラメータ（al.budgetなど）を変更するとフォルダ名になります。
        exclude_keys:
          # --- パスとして既に存在するもの ---
          - run.project_root
          - run.outputs_root
          - run.seed
          - data.qid
          - al.sampler.name
          - al/sampler # これを除外しないと、フォルダ名に "al.sampler=trust" が混ざってしまいます

          # --- 設定グループ（Config Groups） ---
          # これらを除外しないと "run=standard" 等がフォルダ名に付いて長くなりすぎます
          - run
          - train
          - model
          - al
          - infer
          - data
          - split
          - confidence
          - gate
          - cleaner
          - task
          - dataset
          
          # --- 制御用変数 ---
          - run.on_exist
          - run.outputs_dir
          - run.data_dir

  job_logging:
      version: 1
      formatters:
        simple:
          format: "[%(asctime)s][%(name)s][%(levelname)s] - %(message)s"

      handlers:
        console:
          class: logging.StreamHandler
          formatter: simple
          stream: ext://sys.stdout
        file:
          class: logging.FileHandler
          filename: main.log
          formatter: simple

      root:
        level: INFO
        handlers: [console, file]

